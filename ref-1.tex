証明項に対応するものを微妙に導入して、型システムが自動的に判定できる証明を増やした形。

\paragraph*{項やコンテキストの定義}
\begin{grammar}
<term> ::= <variable> 
\alt `Prop'
\alt `Type'
\alt `Fun' <variable> `of' <term> `mapsto' <term>
\alt `Forall' <variable> `of' <term> `to' <term>
\alt `Apply' <term> `and' <term>
\alt `Refined' <term> `with' <term>
\alt `Proof' <term>

<context-snippet> ::= <variable> `:' <term>
\alt Hold <term>

<context> ::= `empty' | <context> `,' <context-snippet>
\end{grammar}

\texttt{Proof} は証明項を陽に扱うためのもの。
命題 \(P\) が示せるときに \(\texttt{Proof } P\) を証明項として扱ってよいとすることで簡単にならないだろうか？
あるいは、
（証明が必要となるところでのみ用いたい）

\paragraph*{項やコンテキストの評価}
ここでコンテキストや項の関係を定義していく。

\begin{itembox}[l]{コンテキストと項の関係}
  \(\vdash \Gamma\) , コンテキストの well-def 性 \\
  \(\Gamma \vdash t_1 : t_2\) , 項の型付け性 \\
  \(\Gamma \vDash t\) , 項の証明可能性 \\
\end{itembox}

\begin{itembox}[l]{コンテキストの well-def}
  \[\infer[\text{context empty}]{\vdash empty}{}\]
  \[\infer[\text{context type}]{\vdash \Gamma , x : A}{\vdash \Gamma & \Gamma \vdash A : \texttt{Type} & x \notin \texttt{FV}(\Gamma)}\]
  \[\infer[\text{context prop}]{\vdash \Gamma , \text{Hold } P}{\vdash \Gamma & \Gamma \vdash P : \texttt{Prop}}\]
\end{itembox}

\begin{itembox}[l]{formation}
  \[\infer[\text{forall formation(type)}]{\Gamma \vdash \texttt{Forall } x \texttt{ of } A_1 \texttt{ to } A_2 : \texttt{Type}}{\Gamma \vdash A_1 : \texttt{Type} & \Gamma , x : A_1 \vdash A_2 : \texttt{Type} }\]
  \[\infer[\text{forall formation(prop)}]{\Gamma \vdash \texttt{Forall } x \texttt{ of } A_1 \texttt{ to } A_2 : \texttt{Prop}}{\Gamma \vdash A_1 : \texttt{Type} & \Gamma , x : A_1 \vdash A_2 : \texttt{Prop} }\]
  \[\infer[\text{refinement formation}]{\Gamma \vdash \texttt{Refined } A \texttt{ with } P : \texttt{Type}}{\Gamma \vdash A : \texttt{Type} & \Gamma \vdash P : \texttt{Forall } x \texttt{ of } A \texttt{ to } \texttt{Prop}}\]
  large elimination に相当するものは除く
\end{itembox}

\begin{itembox}[l]{\(\beta\) 同値について}
  \[\infer[\text{conversion}]{\Gamma \vdash x : A_2}{\Gamma \vdash x : A_1 & A_1 \equiv_{\beta} A_2 & \Gamma \vdash A_2 : \texttt{Type}} \]
  \[\infer[\text{conversion(type)}]{\Gamma \vdash A_2 : \texttt{Type}}{\Gamma \vdash A_1 : \texttt{Type} & A_1 \equiv_{\beta} A_2} \]
  \[\infer[\text{conversion(prop)}]{\Gamma \vdash A_2 : \texttt{Prop}}{\Gamma \vdash A_1 : \texttt{Prop} & A_1 \equiv_{\beta} A_2}\]
  下二つは application と conversion があればいらないかもしれない。
  subject reduction 用につけた
\end{itembox}

\begin{itembox}[l]{よくあるコンテキストのやつ}
  \[\infer[\text{start}]{\Gamma , x : A \vdash x : A}{\vdash \Gamma & \Gamma \vdash A : \texttt{Type}} \]
  \[\infer[\text{weakning}]{\Gamma , x : A_1 \vdash t : A_2}{\vdash \Gamma , x : A_1 & \Gamma \vdash t : A_2} \]
\end{itembox}

\begin{itembox}[l]{introduction と elimination}
  \[\infer[\text{forall introduction}]{\Gamma \vdash \texttt{Fun } x \texttt{ of } A_1 \texttt{ mapsto } t : \texttt{Forall } x \texttt{ of } A_1 \texttt{ to } A_2}{\Gamma , x : A_1 \vdash t : A_2 & \Gamma \vdash \texttt{Forall } x \texttt{ of } A_1 \texttt{ to } A_2 : \texttt{Type}} \]
  \[\infer[\text{forall elimination}]{\Gamma \vdash \texttt{Apply } t_1 \texttt{ and } t_2 : A_2\{x \leftarrow t_2\}}{\Gamma \vdash t_1 : \texttt{Forall } x \texttt{ of } A_1 \texttt{ to } A_2 & \Gamma \vdash t_2 : A_1} \]
  \[\infer[\text{refinement introduction}]{\Gamma \vdash t : \texttt{Refined } A \texttt{ with } P}{\Gamma \vdash t : A & \Gamma \vdash \texttt{Refined } A \texttt{ with } P : \texttt{Type} & \Gamma \vDash \texttt{Apply } P \texttt{ and } t} \]
  \[\infer[\text{refinement elimination}]{\Gamma \vdash t : A}{\Gamma \vdash t : \texttt{Refined } A \texttt{ with } P} \]
\end{itembox}
\begin{itembox}[l]{proo term について}
  \[\infer[\text{proof implicity}]{\Gamma \vDash P}{\Gamma \vdash P : \texttt{Prop} & \Gamma \vdash t : P} \]
  \[\infer[\text{proof explicity}]{\Gamma \vdash \texttt{Proof } P : P}{\Gamma \vdash P : \texttt{Prop} &\Gamma \vDash P} \]
  \[\infer[\text{proof conversion}]{\Gamma \vDash P_2}{\Gamma \vDash P_1 & P_1 \equiv_{\beta} P_2} \]
  \[\infer[\text{refinement inversion}]{\Gamma \vDash \texttt{Apply } P \texttt{ and } t}{\Gamma \vdash P : \texttt{Prop} & \Gamma \vdash t : \texttt{Refined } A \texttt{ with } P}\]
\end{itembox}